!function(){window.hectorAnalyticsLoaded=!0;let e,t=Date.now(),n=new Set,o=[],c=[],a=[],i=!1;const r=e=>`${"localhost"===window.location.hostname?"http://localhost:3000":"https://www.hectoranalytics.com"}/api/${e}`,s=(e,t)=>fetch(e,{method:t?"POST":"GET",headers:{"Content-Type":"application/json"},body:t?JSON.stringify(t):void 0,keepalive:!0}).catch(()=>{}),l=()=>{let e=localStorage.getItem("user_session_id");return e||(e=crypto.randomUUID(),localStorage.setItem("user_session_id",e)),e};function d(){if(document.hidden)return;const e=l(),n=window.location.hostname;s(r("track"),{sessionId:e,page:location.pathname,domain:n,referrer:document.referrer||null,urlParams:window.location.search}).then(()=>{m(e),f(e)}),t=Date.now()}function m(e){const t="localhost"===window.location.hostname?"hectoranalytics.com":window.location.hostname;o.length?h(t,e):s(r("public-funnel-steps")+`?siteId=${t}`).then(e=>e?.ok?e.json():null).then(n=>{n&&(o=n,h(t,e))})}function h(e,t){const c=window.location.pathname;n=new Set,o.forEach(n=>{if("custom_event"!==n.step_type||!n.event_config)return;if(!(!n.event_config.page_pattern||c.includes(n.event_config.page_pattern)))return;const{event_type:o,event_config:a}=n;var i,r;"click"===o&&a.selector?(i=a.selector,r=o=>g(n,e,t,"click",o),document.addEventListener("click",e=>{try{let t=e.target.matches?.(i)?e.target:e.target.closest?.(i);t&&r({selector:i,element:t.tagName.toLowerCase(),text:t.textContent?.trim().substring(0,100)||""})}catch{}})):"scroll"===o?u(n,e,t,!0):"click_link"===o&&a.url_pattern&&function(e,t){const{url_pattern:n,link_text:o,exact_match:c}=e;document.addEventListener("click",e=>{try{const a="A"===e.target.tagName?e.target:e.target.closest("a");if(!a?.href)return;let i;try{i=new URL(a.href).pathname}catch{i=a.href}if(!(c?i===n:i.includes(n)))return;if(o?.trim()&&!a.textContent?.includes(o))return;t({url_pattern:n,link_href:a.href,link_text:a.textContent?.trim()||"",exact_match:c})}catch{}})}(a,o=>g(n,e,t,"click_link",o))})}function u(e,t,o,c){const a=c?e.event_config?.scroll_percentage:e.trigger_config?.scroll_percentage,i=`scroll_${e.id}_${a||"any"}`;if(n.has(i))return;n.add(i);let r=!1;const s=()=>{if(r)return;const n=(window.pageYOffset||document.documentElement.scrollTop)/(document.documentElement.scrollHeight-window.innerHeight)*100;if(!a||n>=a){r=!0;const i={scroll_percentage:a?Math.round(n):"any",target_percentage:a};c?g(e,t,o,"scroll",i):_(e.name,t,o,i),window.removeEventListener("scroll",s)}};window.addEventListener("scroll",s,{passive:!0})}function f(e){const t=window.location.hostname;c.length?w(t,e):s(r("public-custom-events")+`?siteId=${t}`).then(e=>e?.ok?e.json():null).then(n=>{n&&(c=n.filter(e=>e.is_active),c.length&&w(t,e))})}function w(e,t){a=[];const n=c.filter(e=>"click"===e.event_type&&e.event_selector);n.length&&(a=n.map(n=>({event:n,domain:e,sessionId:t})),i||(i=!0,document.addEventListener("click",e=>{a.forEach(({event:t,domain:n,sessionId:o})=>{try{let c=e.target.matches?.(t.event_selector)?e.target:e.target.closest?.(t.event_selector);c&&_(t.name,n,o,{selector:t.event_selector,element:c.tagName.toLowerCase(),text:c.textContent?.trim().substring(0,100)||""})}catch{}})}))),c.forEach(n=>{const{event_type:o,event_selector:c,trigger_config:a}=n;if("form_submit"===o){const o=c||"form";document.addEventListener("submit",c=>{try{c.target.matches?.(o)&&_(n.name,e,t,{form_id:c.target.id||"no-id",form_action:c.target.action||window.location.href})}catch{}})}else if("scroll"===o&&a?.scroll_percentage)u(n,e,t,!1);else if("page_view"===o){const o=a?.page_pattern;o&&!window.location.pathname.includes(o)||_(n.name,e,t,{page_url:window.location.href,page_pattern:o||"all"})}})}function _(e,t,n,o){s(r("track-custom-event"),{site_domain:t,event_name:e,session_id:n,page_url:window.location.href,metadata:o||{}})}function g(e,t,n,o,c){s(r("track-funnel-step"),{step_id:e.id,session_id:n,site_domain:t})}function p(){e&&clearInterval(e),document.hidden||d(),e=setInterval(()=>{Date.now()-t>18e5?v():d()},6e4)}function v(){e&&(clearInterval(e),e=null)}window.hector=(e,t,n)=>{if("track"===e&&t){const e=localStorage.getItem("user_session_id");e&&_(t,window.location.hostname,e,n||{})}},document.addEventListener("visibilitychange",()=>{document.hidden?v():p()}),["mousemove","keypress","scroll","click","touchstart"].forEach(e=>{document.addEventListener(e,()=>{t=Date.now()})});let k=window.location.pathname;const y=()=>{if(k!==window.location.pathname){k=window.location.pathname,o=[],c=[],i=!1,a=[];const e=l();m(e),f(e)}};setInterval(y,1e3),window.addEventListener("popstate",y),"complete"===document.readyState?p():window.addEventListener("load",p,{once:!0})}();